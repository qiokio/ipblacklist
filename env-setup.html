<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP黑名单系统 - 环境变量配置</title>
    <link rel="stylesheet" href="styles/index.css">
    <style>
        .env-docs {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        .env-docs h1 {
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .env-docs h2 {
            margin-top: 40px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 5px;
        }
        .env-docs h3 {
            margin-top: 30px;
        }
        .env-docs code {
            background-color: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }
        .env-docs pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .env-docs table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .env-docs th, .env-docs td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        .env-docs th {
            background-color: #f5f5f5;
        }
        .env-docs ul, .env-docs ol {
            margin-left: 20px;
        }
        .back-to-home {
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container env-docs">
        <div class="back-to-home">
            <a href="/" class="btn btn-secondary">返回首页</a>
        </div>
        
        <h1>IP黑名单系统环境变量配置</h1>

        <h2>概述</h2>
        <p>本文档介绍如何为IP黑名单系统配置必要的环境变量，确保系统安全且正常运行。</p>

        <h2>必要的环境变量</h2>
        <p>以下环境变量必须在部署时设置：</p>
        <table>
            <tr>
                <th>变量名</th>
                <th>说明</th>
                <th>示例值</th>
            </tr>
            <tr>
                <td>ADMIN_USERNAME</td>
                <td>管理员账户用户名</td>
                <td>admin</td>
            </tr>
            <tr>
                <td>ADMIN_PASSWORD</td>
                <td>管理员账户密码</td>
                <td>complex-password-123</td>
            </tr>
            <tr>
                <td>JWT_SECRET</td>
                <td>JWT令牌签名密钥</td>
                <td>your-strong-random-secret-key</td>
            </tr>
        </table>

        <h2>配置方法</h2>
        
        <h3>本地开发环境</h3>
        <ol>
            <li>在项目根目录创建 <code>.dev.vars</code> 文件（该文件已在 .gitignore 中，不会被提交）</li>
            <li>按照以下格式添加环境变量：
                <pre><code>ADMIN_USERNAME="admin"
ADMIN_PASSWORD="your-password"
JWT_SECRET="your-secret-key"</code></pre>
            </li>
            <li>使用 <code>wrangler pages dev</code> 启动本地开发服务器</li>
        </ol>

        <h3>Cloudflare Pages 部署</h3>
        
        <h4>使用 Cloudflare Dashboard</h4>
        <ol>
            <li>登录 <a href="https://dash.cloudflare.com/" target="_blank">Cloudflare Dashboard</a></li>
            <li>进入您的项目 -> Pages -> 选择您的应用</li>
            <li>进入 "Settings" -> "Environment variables"</li>
            <li>添加所需的环境变量</li>
            <li>确保将敏感变量（如 ADMIN_PASSWORD 和 JWT_SECRET）标记为 "Encrypted"</li>
        </ol>

        <h4>使用 wrangler.toml</h4>
        <p>在 <code>wrangler.toml</code> 文件中，您可以为生产环境添加默认值：</p>
        <pre><code>[vars]
ADMIN_USERNAME = "admin"
# 不要在此处放置实际密码和密钥，应通过Dashboard或CI/CD系统设置</code></pre>

        <h2>安全建议</h2>
        <ol>
            <li>使用强密码作为 ADMIN_PASSWORD</li>
            <li>使用至少32字符的随机字符串作为 JWT_SECRET</li>
            <li>定期更换密码和密钥</li>
            <li>不要将实际密码和密钥提交到代码仓库</li>
            <li>在生产环境中，使用Cloudflare Dashboard或CI/CD系统设置敏感环境变量</li>
        </ol>

        <h2>故障排除</h2>
        <p>如果遇到登录问题，请检查：</p>
        <ol>
            <li>环境变量是否正确设置</li>
            <li>JWT_SECRET 是否一致（更改后需要所有用户重新登录）</li>
            <li>检查控制台日志了解更详细的错误信息</li>
        </ol>

        <div class="back-to-home">
            <a href="/" class="btn btn-secondary">返回首页</a>
        </div>
    </div>
</body>
</html> 